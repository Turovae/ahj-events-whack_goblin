!function(){"use strict";class t{constructor(t,e){this.container=t,this.board=null,this.cells=[],this.boardSize=e,this.currentPosition=null,this.drawBoard()}drawBoard(){this.board=document.createElement("div"),this.board.classList.add("board"),this.container.appendChild(this.board);for(let t=0;t<this.boardSize**2;t+=1){const t=document.createElement("div");t.classList.add("cell"),this.board.appendChild(t)}this.cells=Array.from(this.board.children)}getPosition(){let t;do{t=Math.floor(Math.random()*this.cells.length)}while(t===this.currentPosition);return this.currentPosition=t,t}placeCharacter(t){this.cells[this.getPosition()].appendChild(t)}}function e(){return this.element=document.createElement("div"),this.element.classList.add("goblin"),this.element}class i{constructor(t){this._element=t,this._miss=0,this.missEl=null,this._hit=0,this.hitEl=null,this.init()}init(){0===this._element.children.length&&(this._element.innerHTML='\n        Попаданий: <span class="game-state-hit"></span> |\n        Промахов: <span class="game-state-miss"></span>\n      ',this.missEl=this._element.querySelector(".game-state-miss"),this.hitEl=this._element.querySelector(".game-state-hit")),this.clear()}get miss(){return this._miss}set miss(t){this._miss=t,this.missEl.textContent=this._miss}get hit(){return this._hit}set hit(t){this._hit=t,this.hitEl.textContent=this._hit}clear(){this._miss=0,this._hit=0,this.missEl.textContent=this._miss,this.hitEl.textContent=this._hit}}class s{constructor(t,e){this.container=t,this.modal=null,this.callback=e,this.createModal()}createModal(){this.modal=document.createElement("div"),this.modal.classList.add("modal"),this.modal.innerHTML='\n      <h3 class="modal-head">потрачено...</h3>\n      <button class="new-game-btn">Новая игра</button>\n    ',this.modal.querySelector(".new-game-btn").addEventListener("click",this.callback)}open(){this.container.appendChild(this.modal)}close(){this.modal.remove()}}new class{constructor(a,n){this.container=document.querySelector(a),this.board=new t(this.container.querySelector(".board-container"),n),this.goblin=new e,this.gameState=new i(this.container.querySelector(".game-state")),this.startModal=new s(this.container.querySelector(".board-container"),this.startGame.bind(this)),this.onWhack=this.onWhack.bind(this),this.container.addEventListener("click",this.onWhack),this.timeoutId=null,this.timeout=1e3}onWhack(t){t.preventDefault();if(!t.target.closest(".board"))return;t.target.closest(".goblin")&&(this.gameState.hit+=1,this.loop())}loop(){clearInterval(this.timeoutId),this.timeoutId=null,this.gameState.miss>=5?(this.startModal.open(),this.goblin.remove()):(this.board.placeCharacter(this.goblin),this.timeoutId=setTimeout((()=>{this.gameState.miss+=1,this.loop()}),this.getTimeout()))}getTimeout(){return this.timeout/(1+.1*Math.floor(this.gameState.hit/10))}startGame(){this.gameState.clear(),this.startModal.close(),this.loop()}init(){this.startModal.open()}}(".game-container",4).init()}();